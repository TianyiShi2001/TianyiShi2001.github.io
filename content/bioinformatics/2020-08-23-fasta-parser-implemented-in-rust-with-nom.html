---
title: FASTA Parser Implemented in Rust with Nom
author: Tianyi Shi
date: '2020-08-23'
slug: fasta-parser-implemented-in-rust-with-nom
categories:
  - bioinformatics
tags:
  - parser
  - fasta
  - nom
  - Rust
term: 3-Michaelmas
week: -5
tutor: ~
summary: ~
bibliography: ../bib/main.bib
output:
  blogdown::html_page:
    number_sections: yes
    toc: yes
  rmarkdown::pdf_document:
    number_sections: yes
    toc: yes
nocite: ~
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>

<div id="TOC">
<ul>
<li><a href="#parsing-a-single-fasta-record"><span class="toc-section-number">1</span> Parsing a single FASTA Record</a>
<ul>
<li><a href="#representing-the-record-in-rust"><span class="toc-section-number">1.1</span> Representing the Record in Rust</a></li>
<li><a href="#parsing-the-title"><span class="toc-section-number">1.2</span> Parsing the Title</a></li>
</ul></li>
</ul>
</div>

<p>Nom makes it possible to</p>
<div id="parsing-a-single-fasta-record" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Parsing a single FASTA Record</h1>
<p>An example of FASTA record is shown below.</p>
<pre><code>&gt;gi|2765658|emb|Z78533.1|CIZ78533 C.irapeanum 5.8S rRNA gene and ITS1 and ITS2 DNA
CGTAACAAGGTTTCCGTAGGTGAACCTGCGGAAGGATCATTGATGAGACCGTGGAATAAACGATCGAGTG
AATCCGGAGGACCGGTGTACTCAGCTCACCGGGGGCATTGCTCCCGTGGTGACCCTGATTTGTTGTTGGG
CCGCCTCGGGAGCGTCCATGGCGGGTT

&gt;(another FASTA record)</code></pre>
<p>Each record starts with a <code>&gt;</code> character, which is followed by the title on the same line. The title can be further divided into an ID and description, which is separated by a space character. In this case, the ID is ‘gi|2765658|emb|Z78533.1|CIZ78533’ and the description is ‘C.irapeanum 5.8S rRNA gene and ITS1 and ITS2 DNA’.</p>
<p>The sequence starts from the second line. There can be line breaks within the sequence.</p>
<div id="representing-the-record-in-rust" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Representing the Record in Rust</h2>
<p>When we parse data, we <em>parse it into something that is meaningful in that language</em>. In Rust, users can define custom <code>struct</code> and <code>enum</code> data structures, and in this case, a C-like <code>struct</code> is the most appropriate.</p>
<p>To make it simple, we define one two fields, <code>title</code> and <code>seq</code>:</p>
<pre class="rust"><code>fn main(){
#[derive(Debug)]struct Record {  title: String,  seq: String}
}</code></pre>
</div>
<div id="parsing-the-title" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Parsing the Title</h2>
<p>To make it</p>
</div>
</div>
